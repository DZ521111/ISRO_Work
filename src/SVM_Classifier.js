var not_prosopis = /* color: #ff4545 */ee.FeatureCollection(
    [ee.Feature(
        ee.Geometry.Point([72.43042355077885, 24.341731547940554]),
        {
          "prosopis": 0,
          "system:index": "0"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43057911890172, 24.34163868466535]),
        {
          "prosopis": 0,
          "system:index": "1"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43120139139317, 24.341780423321207]),
        {
          "prosopis": 0,
          "system:index": "2"
        }),
    ee.Feature(
        ee.Geometry.Point([72.52673301492703, 24.391932707461635]),
        {
          "prosopis": 0,
          "system:index": "3"
        }),
    ee.Feature(
        ee.Geometry.Point([72.52505931650174, 24.394023726884093]),
        {
          "prosopis": 0,
          "system:index": "4"
        }),
    ee.Feature(
        ee.Geometry.Point([72.52385768686307, 24.392831654631568]),
        {
          "prosopis": 0,
          "system:index": "5"
        }),
    ee.Feature(
        ee.Geometry.Point([72.52829942499173, 24.391092381497508]),
        {
          "prosopis": 0,
          "system:index": "6"
        }),
    ee.Feature(
        ee.Geometry.Point([72.52377185617459, 24.391991334645923]),
        {
          "prosopis": 0,
          "system:index": "7"
        }),
    ee.Feature(
        ee.Geometry.Point([72.50455551314737, 24.41681815503211]),
        {
          "prosopis": 0,
          "system:index": "8"
        }),
    ee.Feature(
        ee.Geometry.Point([72.50395469832803, 24.413887338712822]),
        {
          "prosopis": 0,
          "system:index": "9"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4998777406254, 24.412832228178587]),
        {
          "prosopis": 0,
          "system:index": "10"
        }),
    ee.Feature(
        ee.Geometry.Point([72.51228027511026, 24.414336734965886]),
        {
          "prosopis": 0,
          "system:index": "11"
        }),
    ee.Feature(
        ee.Geometry.Point([72.51202278304483, 24.420022436325773]),
        {
          "prosopis": 0,
          "system:index": "12"
        }),
    ee.Feature(
        ee.Geometry.Point([72.50045709777261, 24.428579813134906]),
        {
          "prosopis": 0,
          "system:index": "13"
        }),
    ee.Feature(
        ee.Geometry.Point([72.49771051574136, 24.43203776647903]),
        {
          "prosopis": 0,
          "system:index": "14"
        }),
    ee.Feature(
        ee.Geometry.Point([72.48638086486245, 24.430533470742247]),
        {
          "prosopis": 0,
          "system:index": "15"
        }),
    ee.Feature(
        ee.Geometry.Point([72.48157434630777, 24.43121724375589]),
        {
          "prosopis": 0,
          "system:index": "16"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4736564652958, 24.435358875349138]),
        {
          "prosopis": 0,
          "system:index": "17"
        }),
    ee.Feature(
        ee.Geometry.Point([72.46721916366006, 24.43485094671672]),
        {
          "prosopis": 0,
          "system:index": "18"
        }),
    ee.Feature(
        ee.Geometry.Point([72.46533088851358, 24.434010906411864]),
        {
          "prosopis": 0,
          "system:index": "19"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4681633012333, 24.439519905954118]),
        {
          "prosopis": 0,
          "system:index": "20"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4767892854252, 24.436765436269066]),
        {
          "prosopis": 0,
          "system:index": "21"
        }),
    ee.Feature(
        ee.Geometry.Point([72.47590952086831, 24.43563237453456]),
        {
          "prosopis": 0,
          "system:index": "22"
        }),
    ee.Feature(
        ee.Geometry.Point([72.47698240447427, 24.435358875349138]),
        {
          "prosopis": 0,
          "system:index": "23"
        }),
    ee.Feature(
        ee.Geometry.Point([72.47595243621255, 24.43485094671672]),
        {
          "prosopis": 0,
          "system:index": "24"
        }),
    ee.Feature(
        ee.Geometry.Point([72.48075895476724, 24.435065839849354]),
        {
          "prosopis": 0,
          "system:index": "25"
        }),
    ee.Feature(
        ee.Geometry.Point([72.47449331450845, 24.44186408807274]),
        {
          "prosopis": 0,
          "system:index": "26"
        }),
    ee.Feature(
        ee.Geometry.Point([72.47224025893594, 24.445224006425793]),
        {
          "prosopis": 0,
          "system:index": "27"
        }),
    ee.Feature(
        ee.Geometry.Point([72.47322731185342, 24.44735321064752]),
        {
          "prosopis": 0,
          "system:index": "28"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4633353250065, 24.447919690116294]),
        {
          "prosopis": 0,
          "system:index": "29"
        }),
    ee.Feature(
        ee.Geometry.Point([72.46545963454629, 24.451728710073446]),
        {
          "prosopis": 0,
          "system:index": "30"
        }),
    ee.Feature(
        ee.Geometry.Point([72.46839933562661, 24.453017890748715]),
        {
          "prosopis": 0,
          "system:index": "31"
        }),
    ee.Feature(
        ee.Geometry.Point([72.46805601287271, 24.458330738572027]),
        {
          "prosopis": 0,
          "system:index": "32"
        }),
    ee.Feature(
        ee.Geometry.Point([72.47279815841104, 24.462432416336316]),
        {
          "prosopis": 0,
          "system:index": "33"
        }),
    ee.Feature(
        ee.Geometry.Point([72.48908453154947, 24.46495195216235]),
        {
          "prosopis": 0,
          "system:index": "34"
        }),
    ee.Feature(
        ee.Geometry.Point([72.49011449981118, 24.467432376174575]),
        {
          "prosopis": 0,
          "system:index": "35"
        }),
    ee.Feature(
        ee.Geometry.Point([72.48781852889444, 24.46184647054784]),
        {
          "prosopis": 0,
          "system:index": "36"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43255559193767, 24.49608026943897]),
        {
          "prosopis": 0,
          "system:index": "37"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42749158131755, 24.500454075450342]),
        {
          "prosopis": 0,
          "system:index": "38"
        }),
    ee.Feature(
        ee.Geometry.Point([72.41693440663494, 24.49990735801965]),
        {
          "prosopis": 0,
          "system:index": "39"
        }),
    ee.Feature(
        ee.Geometry.Point([72.40899506795085, 24.499673049821553]),
        {
          "prosopis": 0,
          "system:index": "40"
        }),
    ee.Feature(
        ee.Geometry.Point([72.44306985127605, 24.50178180788395]),
        {
          "prosopis": 0,
          "system:index": "41"
        }),
    ee.Feature(
        ee.Geometry.Point([72.45088044392742, 24.50174275713016]),
        {
          "prosopis": 0,
          "system:index": "42"
        }),
    ee.Feature(
        ee.Geometry.Point([72.45431367146648, 24.494088575217624]),
        {
          "prosopis": 0,
          "system:index": "43"
        }),
    ee.Feature(
        ee.Geometry.Point([72.44367066609539, 24.493307510049537]),
        {
          "prosopis": 0,
          "system:index": "44"
        }),
    ee.Feature(
        ee.Geometry.Point([72.40908089863933, 24.49350277679633]),
        {
          "prosopis": 0,
          "system:index": "45"
        }),
    ee.Feature(
        ee.Geometry.Point([72.40508977162517, 24.494674370910204]),
        {
          "prosopis": 0,
          "system:index": "46"
        }),
    ee.Feature(
        ee.Geometry.Point([72.40281525838054, 24.496119321951507]),
        {
          "prosopis": 0,
          "system:index": "47"
        }),
    ee.Feature(
        ee.Geometry.Point([72.40912381398357, 24.50568682200094]),
        {
          "prosopis": 0,
          "system:index": "48"
        }),
    ee.Feature(
        ee.Geometry.Point([72.41302911030925, 24.51677640051915]),
        {
          "prosopis": 0,
          "system:index": "49"
        }),
    ee.Feature(
        ee.Geometry.Point([72.40599099385418, 24.516385939026616]),
        {
          "prosopis": 0,
          "system:index": "50"
        }),
    ee.Feature(
        ee.Geometry.Point([72.40028325307048, 24.51505836087453]),
        {
          "prosopis": 0,
          "system:index": "51"
        }),
    ee.Feature(
        ee.Geometry.Point([72.41654816853679, 24.518806780716844]),
        {
          "prosopis": 0,
          "system:index": "52"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4361524607561, 24.53137878875715]),
        {
          "prosopis": 0,
          "system:index": "53"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43740901151834, 24.3422653495402]),
        {
          "prosopis": 0,
          "system:index": "54"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4402843395823, 24.34977235529576]),
        {
          "prosopis": 0,
          "system:index": "55"
        }),
    ee.Feature(
        ee.Geometry.Point([72.44358882108865, 24.34101413864716]),
        {
          "prosopis": 0,
          "system:index": "56"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43172436362457, 24.341755260960497]),
        {
          "prosopis": 0,
          "system:index": "57"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43028133517456, 24.342385751805143]),
        {
          "prosopis": 0,
          "system:index": "58"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42997556334686, 24.342771864803737]),
        {
          "prosopis": 0,
          "system:index": "59"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43140786296081, 24.343084664344524]),
        {
          "prosopis": 0,
          "system:index": "60"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43448703890991, 24.342806077291144]),
        {
          "prosopis": 0,
          "system:index": "61"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43463724261474, 24.341672172785664]),
        {
          "prosopis": 0,
          "system:index": "62"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4292460024948, 24.342068063012178]),
        {
          "prosopis": 0,
          "system:index": "63"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42810874587249, 24.342209801187494]),
        {
          "prosopis": 0,
          "system:index": "64"
        })]),
prosopis = /* color: #218b27 */ee.FeatureCollection(
    [ee.Feature(
        ee.Geometry.Point([72.42408070607993, 24.508703969416835]),
        {
          "prosopis": 1,
          "system:index": "0"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42419751982861, 24.50878340606704]),
        {
          "prosopis": 1,
          "system:index": "1"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43045745187159, 24.502179772964894]),
        {
          "prosopis": 1,
          "system:index": "2"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43171564751738, 24.49656147955268]),
        {
          "prosopis": 1,
          "system:index": "3"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42932970765193, 24.489739856181977]),
        {
          "prosopis": 1,
          "system:index": "4"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42887965703623, 24.488740954467737]),
        {
          "prosopis": 1,
          "system:index": "5"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42859432568797, 24.48850021174431]),
        {
          "prosopis": 1,
          "system:index": "6"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42341708495992, 24.415348796847617]),
        {
          "prosopis": 1,
          "system:index": "7"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42648928357396, 24.413658538303785]),
        {
          "prosopis": 1,
          "system:index": "8"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42664560312757, 24.41337721004125]),
        {
          "prosopis": 1,
          "system:index": "9"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42695824759556, 24.41308965049831]),
        {
          "prosopis": 1,
          "system:index": "10"
        }),
    ee.Feature(
        ee.Geometry.Point([72.50355168823928, 24.364817955860865]),
        {
          "prosopis": 1,
          "system:index": "11"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43715536376834, 24.360430648484726]),
        {
          "prosopis": 1,
          "system:index": "12"
        }),
    ee.Feature(
        ee.Geometry.Point([72.4353097100882, 24.35298295227831]),
        {
          "prosopis": 1,
          "system:index": "13"
        }),
    ee.Feature(
        ee.Geometry.Point([72.43275230872257, 24.349057866566127]),
        {
          "prosopis": 1,
          "system:index": "14"
        }),
    ee.Feature(
        ee.Geometry.Point([72.48128245226923, 24.35871875352373]),
        {
          "prosopis": 1,
          "system:index": "15"
        }),
    ee.Feature(
        ee.Geometry.Point([72.54294323288549, 24.382505765814802]),
        {
          "prosopis": 1,
          "system:index": "16"
        }),
    ee.Feature(
        ee.Geometry.Point([72.53037137807056, 24.391327671913448]),
        {
          "prosopis": 1,
          "system:index": "17"
        }),
    ee.Feature(
        ee.Geometry.Point([72.54197123798232, 24.430719487023392]),
        {
          "prosopis": 1,
          "system:index": "18"
        }),
    ee.Feature(
        ee.Geometry.Point([72.54296053762877, 24.442473575990032]),
        {
          "prosopis": 1,
          "system:index": "19"
        }),
    ee.Feature(
        ee.Geometry.Point([72.42717120421274, 24.411973393363457]),
        {
          "prosopis": 1,
          "system:index": "20"
        })]);
var visualization = {"min":0,"max":0.3,"bands":["B4","B3","B2"]};
var Jessore = ee.FeatureCollection(roi);
var Jessore = Jessore.geometry();
Map.centerObject(Jessore);
Map.addLayer(Jessore,{color: 'red'},'region')
//print(points)


var points = ee.FeatureCollection(points);
points = points.geometry();
Map.centerObject(points);


function maskS2clouds(image) {
var qa = image.select('QA60');

// Bits 10 and 11 are clouds and cirrus, respectively.
var cloudBitMask = 1 << 10;
var cirrusBitMask = 1 << 11;

// Both flags should be set to zero, indicating clear conditions.
var mask = qa.bitwiseAnd(cloudBitMask).eq(0)
  .and(qa.bitwiseAnd(cirrusBitMask).eq(0));

return image.updateMask(mask).divide(10000);
}
var bands = ['B2', 'B3', 'B4', 'B5', 'B6', 'B7', 'NDVI'];

var addNDVI = function(image) {
var ndvi = image.normalizedDifference(['B8', 'B4']).rename('NDVI');
return image.addBands(ndvi);
};

var dataset = ee.ImageCollection('COPERNICUS/S2_SR')
              .filterDate('2020-09-01', '2020-12-29')
              // Pre-filter to get less cloudy granules.
              .filter(ee.Filter.lt('CLOUDY_PIXEL_PERCENTAGE',20))
              .map(maskS2clouds)
              .map(addNDVI)
              .filterBounds(roi)
              //.map(function(image){return image.clip(roi)})
              .select(bands)
              .median();
              
Map.addLayer(dataset, visualization, 'RGB', false);
Map.addLayer(points,{color: 'red'},'points', false);

// Select the bands for training

var newfc = prosopis.merge(not_prosopis);

// Sample the input imagery to get a FeatureCollection of training data.
var training = dataset.sampleRegions({
collection: newfc,
properties: ['prosopis'],
scale: 30
});

print(training.size())
print(training.first())

var label = 'prosopis';
var trained = ee.Classifier.libsvm().train(training, label, bands);

// Classify the image with the same bands used for training.
var classified = dataset.select(bands).classify(trained);

print("Re-substitution Accuracy is :")
print(trained.confusionMatrix().accuracy())

print("Confusion Matrix :")
print(trained.confusionMatrix())

// Define a palette for the Land Use classification.
var palette = [
'red', //not prosopis
'green', //prosopis
];

// Display the classification result and the input

Map.addLayer(classified.clip(Jessore), {min: 0, max: 1, palette: palette}, 'Classification');
classified=classified.clip(Jessore);
/*
Export.image.toDrive({

image: classified.visualize({min: 0, max: 1, palette: ['red','green']}),
description: 'Prosopis',
scale: 30,
region: Jessore
});*/